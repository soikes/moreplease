<html><head><link rel="stylesheet" href="assets/styles.css"><link rel="icon" type="image/x-icon" href="assets/favicon.ico"><title>More SQL Please: GROUP BY</title></head><body><div class="content wide"><div class="title"><h1 class="heading"><a href="/">More SQL Please</a>: <span class="title-em">GROUP BY</span></h1></div><details id="schema" class="toggle"><summary class="action heading" data-open="hide tables" data-close="show tables"></summary><div class="container"><div class="tile"><div class="tablename"><span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#16697a">products</span></code></span></span></div><pre>| id |           name           |  category  | price | remaining_stock | vendor_id |
|----|--------------------------|------------|-------|-----------------|-----------|
| 1  | Cool Splash Cologne      | Toiletries | 49.99 | 25              | 2         |
| 2  | More Spice Please Chips  | Food       | 3.99  | 60              | 1         |
| 3  | Night Shift Coffee       | Food       | 6.99  | 1               | 1         |
| 4  | Crunchy Munchy Trail Mix | Food       | 8.99  | 5               | 3         |
| 5  | Super Glide Floss        | Toiletries | 1.99  | 49              | 4         |
| 6  | Big Bark Dog Food        | Pet Care   | 30    | 2               | 2         |
| 7  | Soft Purr Cat Food       | Pet Care   | 30    | 2               | 2         |
</pre></div><div class="tile"><div class="tablename"><span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#16697a">vendors</span></code></span></span></div><pre>| id |          name           |
|----|-------------------------|
| 1  | Quicky Express Food Co  |
| 2  | Good Times Distributors |
| 3  | Natural Goodness        |
| 4  | Hyper Logistics         |
</pre></div><div class="tile"><div class="tablename"><span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#16697a">orders</span></code></span></span></div><pre>| id | product_id | vendor_id | quantity |    date_ordered     |    date_arrived     |
|----|------------|-----------|----------|---------------------|---------------------|
| 1  | 4          | 3         | 40       | 2024-06-01 07:58:05 | 2024-06-03 09:04:05 |
| 2  | 1          | 2         | 20       | 2024-06-14 19:30:10 | 2024-06-26 14:20:10 |
| 3  | 4          | 3         | 40       | 2024-07-01 09:01:05 | 2024-07-13 09:01:05 |
| 4  | 5          | 4         | 50       | 2024-07-03 01:00:07 | 2024-07-09 12:50:12 |
| 5  | 2          | 1         | 60       | 2024-07-24 06:06:03 | 2024-07-30 15:05:00 |
| 6  | 3          | 1         | 60       | 2024-08-15 16:40:07 | 2024-08-19 07:05:00 |
| 7  | 6          | 4         | 10       | 2024-09-01 08:01:01 | NULL                |
| 8  | 7          | 4         | 10       | 2024-09-01 08:05:09 | NULL                |
</pre></div></div></details><div class="container"><div>The <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span></code></span></span> statement is used when you want to group results together so you can find things out about each group. <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span></code></span></span> is most useful when paired with an aggregate function, which in this case will operate once for each group instead of all the rows together.</div><div class="sticky-container"><div class="tile sticky"><pre style="background-color:#fff;"><code><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#ffa62b">SELECT</span> <span style="color:#16697a">category</span>, <span style="color:#ffa62b">sum</span>(<span style="color:#16697a">remaining_stock</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style="color:#ffa62b">AS</span> <span style="color:#16697a">total_remaining</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#ffa62b">FROM</span> <span style="color:#16697a">products</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span> <span style="color:#16697a">category</span>;
</span></span></code></pre><div><pre>|  category  | total_remaining |
|------------|-----------------|
| Food       | 66              |
| Pet Care   | 4               |
| Toiletries | 74              |
</pre></div></div></div><div>You can use multiple aggregate functions with a <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span></code></span></span> to find more information about each group side by side.</div><div class="sticky-container"><div class="tile sticky"><pre style="background-color:#fff;"><code><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#ffa62b">SELECT</span> <span style="color:#16697a">category</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style="color:#ffa62b">min</span>(<span style="color:#16697a">price</span>) <span style="color:#ffa62b">AS</span> <span style="color:#16697a">min_price</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#ffa62b">max</span>(<span style="color:#16697a">price</span>) <span style="color:#ffa62b">AS</span> <span style="color:#16697a">max_price</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    <span style="color:#16697a">round</span>(<span style="color:#ffa62b">avg</span>(<span style="color:#16697a">price</span>), <span style="color:#8a7b52">2</span>) <span style="color:#ffa62b">AS</span> <span style="color:#16697a">avg_price</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#ffa62b">FROM</span> <span style="color:#16697a">products</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span> <span style="color:#16697a">category</span>;
</span></span></code></pre><div><pre>|  category  | min_price | max_price | avg_price |
|------------|-----------|-----------|-----------|
| Food       | 3.99      | 8.99      | 6.66      |
| Pet Care   | 30        | 30        | 30        |
| Toiletries | 1.99      | 49.99     | 25.99     |
</pre></div></div></div><div>The <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">HAVING</span></code></span></span> clause can be applied to a <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span></code></span></span>, which will only include rows in the group that match the clause. It is similar to a <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">WHERE</span></code></span></span> clause but with key differences:<br><br><span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">WHERE</span></code></span></span> filters rows before they are grouped and <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">HAVING</span></code></span></span> filters rows after groups are formed. Because of this, only the <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">HAVING</span></code></span></span> clause can accept aggeregated values.</div><div class="sticky-container"><div class="tile sticky"><pre style="background-color:#fff;"><code><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#ffa62b">SELECT</span> <span style="color:#16697a">category</span>, <span style="color:#ffa62b">sum</span>(<span style="color:#16697a">remaining_stock</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style="color:#ffa62b">AS</span> <span style="color:#16697a">total_remaining</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#ffa62b">FROM</span> <span style="color:#16697a">products</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span> <span style="color:#16697a">category</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#ffa62b">HAVING</span> <span style="color:#16697a">total_remaining</span> <span style="color:#90708c">&lt;</span> <span style="color:#8a7b52">5</span>;
</span></span></code></pre><div><pre>| category | total_remaining |
|----------|-----------------|
| Pet Care | 4               |
</pre></div></div></div><div><span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span></code></span></span> can be used alongside other clauses like <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">JOIN</span></code></span></span>.<br><br>In logistics, lead time is how long it takes to receive something after ordering it. In this example we group by vendor then use the <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">avg</span>()</code></span></span> function with the lead time of each order to find the average lead time for each vendor.<br><br>We group by a vendor's <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#16697a">id</span></code></span></span> instead of <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#16697a">name</span></code></span></span> because vendors might have the same name as one another but they always have a unique id. This ensures that our groups contain the correct order data for each unique vendor.<br><br><span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#16697a">julianday</span>()</code></span></span> is a built-in function that helps us perform arithmetic on <a href="date_and_time">dates</a> in SQLite.</div><div class="sticky-container"><div class="tile sticky"><pre style="background-color:#fff;"><code><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#ffa62b">SELECT</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>    <span style="color:#16697a">v</span>.<span style="color:#16697a">name</span> <span style="color:#ffa62b">AS</span> <span style="color:#16697a">vendor</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>    <span style="color:#ffa62b">avg</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>        <span style="color:#16697a">round</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>            <span style="color:#16697a">julianday</span>(<span style="color:#16697a">o</span>.<span style="color:#16697a">date_arrived</span>) <span style="color:#90708c">-</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>            <span style="color:#16697a">julianday</span>(<span style="color:#16697a">o</span>.<span style="color:#16697a">date_ordered</span>), 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>            <span style="color:#8a7b52">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>        )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>    ) <span style="color:#ffa62b">AS</span> <span style="color:#16697a">average_lead_time_days</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span><span style="color:#ffa62b">FROM</span> <span style="color:#16697a">vendors</span> <span style="color:#16697a">v</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span><span style="color:#ffa62b">INNER</span> <span style="color:#ffa62b">JOIN</span> <span style="color:#16697a">orders</span> <span style="color:#16697a">o</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#ffa62b">ON</span> <span style="color:#16697a">v</span>.<span style="color:#16697a">id</span> <span style="color:#90708c">=</span> <span style="color:#16697a">o</span>.<span style="color:#16697a">vendor_id</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span> <span style="color:#16697a">v</span>.<span style="color:#16697a">id</span>;
</span></span></code></pre><div><pre>|         vendor          | average_lead_time_days |
|-------------------------|------------------------|
| Quicky Express Food Co  | 5                      |
| Good Times Distributors | 12                     |
| Natural Goodness        | 7                      |
| Hyper Logistics         | 6                      |
</pre></div></div></div><div>If you supply multiple columns to a <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span></code></span></span>, groups are formed based on all the unique combinations of data from those columns.<br><br>Here we group by both the product category and the month we made an order for that category. <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">count</span>(<span style="color:#90708c">*</span>)</code></span></span> will then count how many rows are in each group, telling us how many orders there are in each group.<br><br></div><div class="sticky-container"><div class="tile sticky"><pre style="background-color:#fff;"><code><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#ffa62b">SELECT</span> <span style="color:#16697a">strftime</span>(<span style="color:#7f8c8d">&#34;</span><span style="color:#7f8c8d">%m</span><span style="color:#7f8c8d">&#34;</span>, <span style="color:#16697a">o</span>.<span style="color:#16697a">date_ordered</span>) <span style="color:#ffa62b">AS</span> <span style="color:#ffa62b">month</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style="color:#16697a">p</span>.<span style="color:#16697a">category</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#ffa62b">count</span>(<span style="color:#90708c">*</span>) <span style="color:#ffa62b">AS</span> <span style="color:#16697a">total_orders</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#ffa62b">FROM</span> <span style="color:#16697a">orders</span> <span style="color:#16697a">o</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#ffa62b">INNER</span> <span style="color:#ffa62b">JOIN</span> <span style="color:#16697a">products</span> <span style="color:#16697a">p</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>    <span style="color:#ffa62b">ON</span> <span style="color:#16697a">o</span>.<span style="color:#16697a">product_id</span> <span style="color:#90708c">=</span> <span style="color:#16697a">p</span>.<span style="color:#16697a">id</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span> <span style="color:#ffa62b">month</span>, <span style="color:#16697a">p</span>.<span style="color:#16697a">category</span>;
</span></span></code></pre><div><pre>| month |  category  | total_orders |
|-------|------------|--------------|
| 06    | Food       | 1            |
| 06    | Toiletries | 1            |
| 07    | Food       | 2            |
| 07    | Toiletries | 1            |
| 08    | Food       | 1            |
| 09    | Pet Care   | 2            |
</pre></div></div></div><div>Now lets say we want to see the most recent order totals first. <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">ORDER</span> <span style="color:#ffa62b">BY</span></code></span></span> can be applied at the end of the query to sort the months in descending order.</div><div class="sticky-container"><div class="tile sticky"><pre style="background-color:#fff;"><code><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#ffa62b">SELECT</span> <span style="color:#16697a">strftime</span>(<span style="color:#7f8c8d">&#34;</span><span style="color:#7f8c8d">%m</span><span style="color:#7f8c8d">&#34;</span>, <span style="color:#16697a">o</span>.<span style="color:#16697a">date_ordered</span>) <span style="color:#ffa62b">AS</span> <span style="color:#ffa62b">month</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style="color:#16697a">p</span>.<span style="color:#16697a">category</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#ffa62b">count</span>(<span style="color:#90708c">*</span>) <span style="color:#ffa62b">AS</span> <span style="color:#16697a">total_orders</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#ffa62b">FROM</span> <span style="color:#16697a">orders</span> <span style="color:#16697a">o</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#ffa62b">INNER</span> <span style="color:#ffa62b">JOIN</span> <span style="color:#16697a">products</span> <span style="color:#16697a">p</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>    <span style="color:#ffa62b">ON</span> <span style="color:#16697a">o</span>.<span style="color:#16697a">product_id</span> <span style="color:#90708c">=</span> <span style="color:#16697a">p</span>.<span style="color:#16697a">id</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span> <span style="color:#ffa62b">month</span>, <span style="color:#16697a">p</span>.<span style="color:#16697a">category</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span><span style="color:#ffa62b">ORDER</span> <span style="color:#ffa62b">BY</span> <span style="color:#ffa62b">month</span> <span style="color:#ffa62b">DESC</span>;
</span></span></code></pre><div><pre>| month |  category  | total_orders |
|-------|------------|--------------|
| 09    | Pet Care   | 2            |
| 08    | Food       | 1            |
| 07    | Food       | 2            |
| 07    | Toiletries | 1            |
| 06    | Food       | 1            |
| 06    | Toiletries | 1            |
</pre></div></div></div><div>The <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">DISTINCT</span></code></span></span> clause can be added to an aggregate function like <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">count</span>()</code></span></span>. In this case we want to see how many different vendors we have for each product category to make sure we can negotiate the best prices.<br><br>Without the <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">DISTINCT</span></code></span></span> clause in this query it would return a row count of all the products in each category even if the same vendor appears multiple times. We would have thought we had two Pet Care vendors when really we only have one.</div><div class="sticky-container"><div class="tile sticky"><pre style="background-color:#fff;"><code><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#ffa62b">SELECT</span> <span style="color:#16697a">category</span>, <span style="color:#ffa62b">count</span>(<span style="color:#ffa62b">DISTINCT</span> <span style="color:#16697a">vendor_id</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style="color:#ffa62b">AS</span> <span style="color:#16697a">vendors</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#ffa62b">FROM</span> <span style="color:#16697a">products</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span> <span style="color:#16697a">category</span>;
</span></span></code></pre><div><pre>|  category  | vendors |
|------------|---------|
| Food       | 2       |
| Pet Care   | 1       |
| Toiletries | 2       |
</pre></div></div></div><div><span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">NULL</span></code></span></span> values form their own group when they are found by a <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span></code></span></span>.<br><br>In this schema an order has a <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">NULL</span></code></span></span> arrival date if it hasn't arrived yet. This query will show us unfulfilled orders as a <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">NULL</span></code></span></span> arrival month alongside fulfilled orders.<br><br>If we wanted something more informative to display like "Not Arrived" or "Pending", we could use the <a href="/functions#coalesce">coalesce() function</a>.</div><div class="sticky-container"><div class="tile sticky"><pre style="background-color:#fff;"><code><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#ffa62b">SELECT</span> <span style="color:#16697a">strftime</span>(<span style="color:#7f8c8d">&#34;</span><span style="color:#7f8c8d">%m</span><span style="color:#7f8c8d">&#34;</span>, <span style="color:#16697a">date_arrived</span>) <span style="color:#ffa62b">AS</span> <span style="color:#16697a">month_arrived</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style="color:#ffa62b">count</span>(<span style="color:#90708c">*</span>) <span style="color:#ffa62b">AS</span> <span style="color:#16697a">orders</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#ffa62b">FROM</span> <span style="color:#16697a">orders</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span> <span style="color:#16697a">month_arrived</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#ffa62b">ORDER</span> <span style="color:#ffa62b">BY</span> <span style="color:#16697a">month_arrived</span> <span style="color:#ffa62b">ASC</span>;
</span></span></code></pre><div><pre>| month_arrived | orders |
|---------------|--------|
| NULL          | 2      |
| 06            | 2      |
| 07            | 3      |
| 08            | 1      |
</pre></div></div></div><div>As usual, a <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">WHERE</span></code></span></span> clause can be applied to any of these queries. This time, we filter out unfulfilled orders before they are grouped by month.<br><br>This example also shows <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">WHERE</span></code></span></span> and <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">HAVING</span></code></span></span> being used together.</div><div class="sticky-container"><div class="tile sticky"><pre style="background-color:#fff;"><code><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#ffa62b">SELECT</span> <span style="color:#ffa62b">count</span>(<span style="color:#90708c">*</span>) <span style="color:#ffa62b">AS</span> <span style="color:#16697a">fulfilled_orders</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style="color:#16697a">strftime</span>(<span style="color:#7f8c8d">&#34;</span><span style="color:#7f8c8d">%m</span><span style="color:#7f8c8d">&#34;</span>, <span style="color:#16697a">date_arrived</span>) <span style="color:#ffa62b">AS</span> <span style="color:#ffa62b">month</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#ffa62b">FROM</span> <span style="color:#16697a">orders</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#ffa62b">WHERE</span> <span style="color:#ffa62b">month</span> <span style="color:#ffa62b">IS</span> <span style="color:#ffa62b">NOT</span> <span style="color:#ffa62b">NULL</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span> <span style="color:#ffa62b">month</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span><span style="color:#ffa62b">HAVING</span> <span style="color:#16697a">fulfilled_orders</span> <span style="color:#90708c">&gt;</span> <span style="color:#8a7b52">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span><span style="color:#ffa62b">ORDER</span> <span style="color:#ffa62b">BY</span> <span style="color:#ffa62b">month</span> <span style="color:#ffa62b">ASC</span>;
</span></span></code></pre><div><pre>| fulfilled_orders | month |
|------------------|-------|
| 3                | 07    |
</pre></div></div></div><div>Any selected columns that are not part of an aggregate function or included in the <span><span class="inline-code"><code style="background-color:#fff;"><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span></code></span></span> clause are called "bare" columns. Many databases will treat bare columns as an error because they create ambiguity in which value to return.<br><br>SQLite does allow bare columns but it's generally recommended not to include them in your queries. In this case we returned an arbitrary product name belonging to each category which is not very useful.</div><div class="sticky-container"><div class="tile sticky"><pre style="background-color:#fff;"><code><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#ffa62b">SELECT</span> <span style="color:#16697a">name</span>, <span style="color:#16697a">category</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#ffa62b">FROM</span> <span style="color:#16697a">products</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#ffa62b">GROUP</span> <span style="color:#ffa62b">BY</span> <span style="color:#16697a">category</span>;
</span></span></code></pre><div><pre>|          name           |  category  |
|-------------------------|------------|
| More Spice Please Chips | Food       |
| Big Bark Dog Food       | Pet Care   |
| Cool Splash Cologne     | Toiletries |
</pre></div></div></div></div></div></body></html>